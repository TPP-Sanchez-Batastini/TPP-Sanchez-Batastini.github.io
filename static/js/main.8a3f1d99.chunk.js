/*! For license information please see main.8a3f1d99.chunk.js.LICENSE.txt */
(this["webpackJsonptpp-driving-simulator"]=this["webpackJsonptpp-driving-simulator"]||[]).push([[0],{144:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return a}));var n=s(3),i=s(4),a=function(){function t(e){Object(n.a)(this,t),this.car=e}return Object(i.a)(t,[{key:"handleAccelerate",value:function(t,e){this.car.accelerate(t,e)}},{key:"handleBrake",value:function(t,e){this.car.brake(t,e)}},{key:"changeShift",value:function(t,e){this.car.changeShift(t,e)}},{key:"turnDirection",value:function(t){this.car.turnDirection(t)}},{key:"turnOnCar",value:function(){this.car.turnOnCar()}},{key:"updateCar",value:function(){this.car.update()}},{key:"changeShiftBox",value:function(t){this.car.changeShiftBox(t)}}]),t}()},232:function(t,e,s){},241:function(t,e){},243:function(t,e){},253:function(t,e){},255:function(t,e){},280:function(t,e){},282:function(t,e){},283:function(t,e){},288:function(t,e){},290:function(t,e){},296:function(t,e){},298:function(t,e){},317:function(t,e){},329:function(t,e){},332:function(t,e){},336:function(t,e,s){"use strict";s.r(e);var n=s(0),i=s.n(n),a=s(201),r=s.n(a),o=(s(232),s(10)),h=s(19),c=s(3),u=s(4),l=s(6),d=s(7),b=s(1),p=function(){function t(){Object(c.a)(this,t),this.observedState=null}return Object(u.a)(t,[{key:"update",value:function(t){this.observedState=t}}]),t}(),f=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this)).camera=new b.fb(85,window.innerWidth/window.innerHeight,.1,200),n.group=new b.db,n.group180Rot=(new b.db).add(n.camera),n.group.add(n.group180Rot),n.renderer=t,n}return Object(u.a)(s,[{key:"handleResize",value:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()}},{key:"setPositionRelativeToObject",value:function(){var t=new b.Gb(.35,.6,-.1);if(null!=this.observedState)if(t.applyQuaternion(this.observedState.rotation),this.group.position.copy(this.observedState.position).add(t),"true"===localStorage.getItem("VR")){var e=new b.Gb(0,-1.25,0);e.applyQuaternion(this.observedState.rotation),this.group.position.add(e),this.group.setRotationFromQuaternion(this.observedState.rotation),this.group180Rot.setRotationFromAxisAngle(new b.Gb(0,1,0),Math.PI),this.camera.lookAt(new b.Gb(0,0,5))}else{var s=new b.lb(this.observedState.rotation.x,this.observedState.rotation.y,this.observedState.rotation.z,this.observedState.rotation.w).normalize();this.group180Rot.setRotationFromAxisAngle(new b.Gb(0,1,0),-5*Math.PI/180),this.group.quaternion.copy(s)}else this.camera.lookAt(new b.Gb(0,0,5))}},{key:"getCameraInstance",value:function(){return this.camera}},{key:"addContainerToScene",value:function(t){t.add(this.group)}}]),s}(p),v=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this)).positionCamera=t,n.camera=new b.fb(75,window.innerWidth/window.innerHeight,.1,1e3),n}return Object(u.a)(s,[{key:"handleResize",value:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()}},{key:"setPositionRelativeToObject",value:function(){var t=new b.Gb(this.positionCamera.x,this.positionCamera.y,this.positionCamera.z);if(null!=this.observedState){var e=t.applyQuaternion(this.observedState.rotation);this.camera.position.copy(this.observedState.position).add(e);var s=new b.Gb(this.observedState.position.x,this.observedState.position.y,this.observedState.position.z);this.camera.lookAt(s)}else this.camera.lookAt(new b.Gb(0,0,0)),this.camera.position.copy(t)}},{key:"getCameraInstance",value:function(){return this.camera}}]),s}(p),g=s(202),m=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this)).camera=new b.fb(75,window.innerWidth/window.innerHeight,.1,1e3),n.renderer=t,n.controls=new g.a(n.camera,n.renderer.domElement),n.controls.enableDamping=!0,n.controls.dampingFactor=.25,n.controls.enableZoom=!0,n.camera.position.set(0,5.5,0),n}return Object(u.a)(s,[{key:"handleResize",value:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()}},{key:"getCameraInstance",value:function(){return this.camera}},{key:"setPositionRelativeToObject",value:function(){this.controls.update(),null!=this.observedState?this.camera.lookAt(this.observedState.position):this.camera.lookAt(new b.Gb(0,0,0))}}]),s}(p),j=s(11),y=s(9),w=s(213),O=s(203),x=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this)).fbxLoader=new w.a,n.gltfLoader=new O.a,n.threeDModel=null,n.pathToTexture=t,n}return Object(u.a)(s,[{key:"loadFBX",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e,s;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.pathToTexture,t.next=3,this.fbxLoader.loadAsync(e,(function(t){return t}));case 3:return s=t.sent,t.abrupt("return",s);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"loadGLTF",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e,s;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.pathToTexture,t.next=3,this.gltfLoader.loadAsync(e,(function(t){return t}));case 3:return s=t.sent,t.abrupt("return",s);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"addToScene",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(e,s,n,i){var a;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.threeDModel){t.next=22;break}return t.prev=1,t.next=4,this.loadFBX();case 4:a=t.sent,this.threeDModel=a,t.next=14;break;case 8:return t.prev=8,t.t0=t.catch(1),t.next=12,this.loadGLTF();case 12:a=t.sent,this.threeDModel=a.scene;case 14:this.threeDModel.name=s,this.threeDModel.position.x=n[0],this.threeDModel.position.y=n[1],this.threeDModel.position.z=n[2],this.threeDModel.scale.x=i[0],this.threeDModel.scale.y=i[1],this.threeDModel.scale.z=i[2],e.add(this.threeDModel);case 22:return t.abrupt("return",this);case 23:case"end":return t.stop()}}),t,this,[[1,8]])})));return function(e,s,n,i){return t.apply(this,arguments)}}()},{key:"getModel",value:function(){return this.threeDModel}},{key:"animate",value:function(){return null}}]),s}(p),S=s(30),P=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(c.a)(this,s),(n=e.call(this,t)).isReflector=!0,n.type="Reflector",n.camera=new b.fb(null,null,.1,10);var a=Object(S.a)(n),r=void 0!==i.color?new b.j(i.color):new b.j(8355711),o=i.textureWidth||512,h=i.textureHeight||512,u=i.clipBias||0,l=i.shader||s.ReflectorShader,d=void 0!==i.multisample?i.multisample:4,p=new b.gb,f=new b.Gb,v=new b.Gb,g=new b.Gb,m=new b.Q,j=new b.Gb(0,0,-1),y=new b.Hb,w=new b.Gb,O=new b.Gb,x=new b.Hb,P=new b.Q,R=n.camera,k=new b.Jb(o,h,{samples:d,type:b.v}),M=new b.pb({uniforms:b.Eb.clone(l.uniforms),fragmentShader:l.fragmentShader,vertexShader:l.vertexShader});return M.uniforms.tDiffuse.value=k.texture,M.uniforms.color.value=r,M.uniforms.textureMatrix.value=P,n.material=M,n.onBeforeRender=function(t,e,s){if(v.setFromMatrixPosition(a.matrixWorld),g.setFromMatrixPosition(s.matrixWorld),m.extractRotation(a.matrixWorld),f.set(0,0,1),f.applyMatrix4(m),w.subVectors(v,g),!(w.dot(f)>0)){w.reflect(f).negate(),w.add(v),m.extractRotation(s.matrixWorld),j.set(0,0,-1),j.applyMatrix4(m),j.add(g),O.subVectors(v,j),O.reflect(f).negate(),O.add(v),R.position.copy(w),R.up.set(0,1,0),R.up.applyMatrix4(m),R.up.reflect(f),R.lookAt(O),R.far=s.far,R.updateMatrixWorld(),R.projectionMatrix.copy(s.projectionMatrix),P.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),P.multiply(R.projectionMatrix),P.multiply(R.matrixWorldInverse),P.multiply(a.matrixWorld),p.setFromNormalAndCoplanarPoint(f,v),p.applyMatrix4(R.matrixWorldInverse),y.set(p.normal.x,p.normal.y,p.normal.z,p.constant);var n=R.projectionMatrix;x.x=(Math.sign(y.x)+n.elements[8])/n.elements[0],x.y=(Math.sign(y.y)+n.elements[9])/n.elements[5],x.z=-1,x.w=(1+n.elements[10])/n.elements[14],y.multiplyScalar(2/y.dot(x)),n.elements[2]=y.x,n.elements[6]=y.y,n.elements[10]=y.z+1-u,n.elements[14]=y.w,a.visible=!1;var i=t.getRenderTarget(),r=t.xr.enabled,o=t.shadowMap.autoUpdate,h=t.outputColorSpace,c=t.toneMapping;t.xr.enabled=!1,t.shadowMap.autoUpdate=!1,t.outputColorSpace=b.J,t.toneMapping=b.bb,t.setRenderTarget(k),t.state.buffers.depth.setMask(!0),!1===t.autoClear&&t.clear(),t.render(e,R),t.xr.enabled=r,t.shadowMap.autoUpdate=o,t.outputColorSpace=h,t.toneMapping=c,t.setRenderTarget(i);var l=s.viewport;void 0!==l&&t.state.viewport(l),a.visible=!0}},n.getRenderTarget=function(){return k},n.dispose=function(){k.dispose(),a.material.dispose()},n}return Object(u.a)(s)}(b.R);P.ReflectorShader={uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:"\n\t\tuniform mat4 textureMatrix;\n\t\tvarying vec4 vUv;\n\n\t\t#include <common>\n\t\t#include <logdepthbuf_pars_vertex>\n\n\t\tvoid main() {\n\n\t\t\tvUv = textureMatrix * vec4( position, 1.0 );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t#include <logdepthbuf_vertex>\n\n\t\t}",fragmentShader:"\n\t\tuniform vec3 color;\n\t\tuniform sampler2D tDiffuse;\n\t\tvarying vec4 vUv;\n\n\t\t#include <logdepthbuf_pars_fragment>\n\n\t\tfloat blendOverlay( float base, float blend ) {\n\n\t\t\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n\n\t\t}\n\n\t\tvec3 blendOverlay( vec3 base, vec3 blend ) {\n\n\t\t\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <logdepthbuf_fragment>\n\n\t\t\tvec4 base = texture2DProj( tDiffuse, vUv );\n\t\t\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\n\t\t}"};var R=[1,1,1],k=[0,0,0],M=.75,T=1/3600,C=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){var t;return Object(c.a)(this,s),(t=e.call(this,"res/models/source/AutoConInterior.glb")).carModel=null,t.carLogic=null,t.lastValueRotation=0,t.currentSpeedRotation=0,t.currentWheelRotation=0,t.lastSteeringRotation=0,t.lastVelocityRotation=0,t.lastRPMRotation=0,t}return Object(u.a)(s,[{key:"generateRetrovisor",value:function(){var t=new b.qb;t.absellipse(0,0,.15,.075,0,2*Math.PI,!1,0);var e=new b.rb(t),s=new P(e,{textureWidth:512,textureHeight:512,clipBias:.35,multisample:2});s.rotateX(-Math.PI),s.rotateY(.3),s.position.set(0,.625,.375),this.threeDModel.add(s)}},{key:"generateLeftMirror",value:function(){var t=new b.qb;t.absellipse(0,0,.105,.075,0,2*Math.PI,!1,0);var e=new b.rb(t),s=new P(e,{textureWidth:512,textureHeight:512,clipBias:0,multisample:2}),n=new b.db;n.add(s),n.position.set(1.148,.394,.538),n.rotateX(.03-Math.PI),s.rotateY(-26*Math.PI/180),this.threeDModel.add(n)}},{key:"generateRightMirror",value:function(){var t=new b.qb;t.absellipse(0,0,.105,.075,0,2*Math.PI,!1,0);var e=new b.rb(t),s=new P(e,{textureWidth:512,textureHeight:512,clipBias:0,multisample:2}),n=new b.db;n.add(s),n.position.set(-1.138,.394,.53),n.rotateX(-Math.PI+2.9*Math.PI/180),s.rotateY(28.2*Math.PI/180),this.threeDModel.add(n)}},{key:"generateMirrors",value:function(){this.generateRetrovisor(),this.generateLeftMirror(),this.generateRightMirror()}},{key:"addToScene",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(e){return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(j.a)(Object(y.a)(s.prototype),"addToScene",this).call(this,e,"driverCar",k,R);case 2:return this.generateMirrors(),t.abrupt("return",this);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"animate",value:function(){this.moveCar()}},{key:"addPhysicsView",value:function(t){this.physicsShape=new b.Gb(2,1.35,5);var e=new b.e(this.physicsShape.x,this.physicsShape.y,this.physicsShape.z),s=new b.S({color:255});this.PHYSICSSQUARE=new b.R(e,s),this.PHYSICSSQUARE.position.set(0,0,0),t.add(this.PHYSICSSQUARE);var n=new b.l(.35,.35,.35,32,32);n.rotateZ(Math.PI/2);var i=new b.S({color:16711680});this.wheelMesh1=new b.R(n,i),this.wheelMesh1.position.set(0,4,0),t.add(this.wheelMesh1),this.wheelMesh2=new b.R(n,i),this.wheelMesh2.position.set(0,4,0),t.add(this.wheelMesh2),this.wheelMesh3=new b.R(n,i),this.wheelMesh3.position.set(0,4,0),t.add(this.wheelMesh3),this.wheelMesh4=new b.R(n,i),this.wheelMesh4.position.set(0,4,0),t.add(this.wheelMesh4)}},{key:"watchPhysicsColliders",value:function(){null!=this.observedState&&(this.PHYSICSSQUARE.position.set(this.observedState.position.x,this.observedState.position.y,this.observedState.position.z),this.PHYSICSSQUARE.quaternion.set(this.observedState.rotation.x,this.observedState.rotation.y,this.observedState.rotation.z,this.observedState.rotation.w),this.wheelMesh1.position.set(this.observedState.wheelsData[0].position.x,this.observedState.wheelsData[0].position.y,this.observedState.wheelsData[0].position.z),this.wheelMesh1.quaternion.set(this.observedState.wheelsData[0].rotation.x,this.observedState.wheelsData[0].rotation.y,this.observedState.wheelsData[0].rotation.z,this.observedState.wheelsData[0].rotation.w),this.wheelMesh2.position.set(this.observedState.wheelsData[1].position.x,this.observedState.wheelsData[1].position.y,this.observedState.wheelsData[1].position.z),this.wheelMesh2.quaternion.set(this.observedState.wheelsData[1].rotation.x,this.observedState.wheelsData[1].rotation.y,this.observedState.wheelsData[1].rotation.z,this.observedState.wheelsData[1].rotation.w),this.wheelMesh3.position.set(this.observedState.wheelsData[2].position.x,this.observedState.wheelsData[2].position.y,this.observedState.wheelsData[2].position.z),this.wheelMesh3.quaternion.set(this.observedState.wheelsData[2].rotation.x,this.observedState.wheelsData[2].rotation.y,this.observedState.wheelsData[2].rotation.z,this.observedState.wheelsData[2].rotation.w),this.wheelMesh4.position.set(this.observedState.wheelsData[3].position.x,this.observedState.wheelsData[3].position.y,this.observedState.wheelsData[3].position.z),this.wheelMesh4.quaternion.set(this.observedState.wheelsData[3].rotation.x,this.observedState.wheelsData[3].rotation.y,this.observedState.wheelsData[3].rotation.z,this.observedState.wheelsData[3].rotation.w))}},{key:"moveCar",value:function(){null!=this.observedState&&(this.threeDModel.userData.physicsBody=this.observedState.physicsBody,this.threeDModel.position.set(this.observedState.position.x,this.observedState.position.y,this.observedState.position.z),this.threeDModel.quaternion.set(this.observedState.rotation.x,this.observedState.rotation.y,this.observedState.rotation.z,this.observedState.rotation.w),this.lastValueRotation=this.observedState.direction,this.rotateWheels(),this.rotateSteeringWheel(),this.rotateVelocityAndRPM())}},{key:"rotateSteeringWheel",value:function(){var t=this.threeDModel.children.find((function(t){return"Steering_Wheel"===t.name})),e=new b.Gb(0,0,1).applyAxisAngle(new b.Gb(1,0,0),-.35);t.rotateOnAxis(e,-this.lastSteeringRotation),t.rotateOnAxis(e,540*-this.observedState.lastRotationWheel/360*Math.PI*2),this.lastSteeringRotation=540*-this.observedState.lastRotationWheel/360*Math.PI*2}},{key:"rotateVelocityAndRPM",value:function(){var t=this.threeDModel.children.find((function(t){return"Cubo"===t.name})),e=this.threeDModel.children.find((function(t){return"Cubo001"===t.name})),s=-Math.abs(this.observedState.velocity)*(240*Math.PI/180)/240,n=-this.observedState.rpm*(260*Math.PI/180)/6e3;t.rotateOnAxis(new b.Gb(0,1,0),-this.lastVelocityRotation),t.rotateOnAxis(new b.Gb(0,1,0),s),e.rotateOnAxis(new b.Gb(0,1,0),-this.lastRPMRotation),e.rotateOnAxis(new b.Gb(0,1,0),n),this.lastVelocityRotation=s,this.lastRPMRotation=n}},{key:"rotateWheels",value:function(){var t=this.threeDModel.children.find((function(t){return"wheel002"===t.name})),e=this.threeDModel.children.find((function(t){return"wheel"===t.name})),s=this.threeDModel.children.find((function(t){return"wheel003"===t.name})),n=this.threeDModel.children.find((function(t){return"wheel001"===t.name})),i=new b.Gb(0,1,0).applyAxisAngle(new b.Gb(1,0,0),this.currentSpeedRotation),a=new b.Gb(0,1,0).applyAxisAngle(new b.Gb(1,0,0),-this.currentSpeedRotation);e.rotateOnAxis(a,this.currentWheelRotation),t.rotateOnAxis(i,this.currentWheelRotation),e.rotateX(this.observedState.velocity*T*4),t.rotateX(-this.observedState.velocity*T*4),s.rotateX(-this.observedState.velocity*T*4),n.rotateX(this.observedState.velocity*T*4),i=new b.Gb(0,1,0).applyAxisAngle(new b.Gb(1,0,0),this.currentSpeedRotation+this.observedState.velocity*T*4),a=new b.Gb(0,1,0).applyAxisAngle(new b.Gb(1,0,0),-this.currentSpeedRotation-this.observedState.velocity*T*4),e.rotateOnAxis(a,-this.observedState.lastRotationWheel*M),t.rotateOnAxis(i,-this.observedState.lastRotationWheel*M),this.currentWheelRotation=this.observedState.lastRotationWheel*M,this.currentSpeedRotation+=this.observedState.velocity*T*4,this.currentSpeedRotation>=2*Math.PI&&(this.currentSpeedRotation-=2*Math.PI)}}]),s}(x),A=s(144).default,D=function(){function t(e){Object(c.a)(this,t),this.carLogic=e;var s=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[];this.gamepad=null;for(var n=0;n<s.length;n++)s[n]&&s[n].id.startsWith("G29 Driving Force Racing Wheel")&&(this.gamepad=s[n]);this.buttonX=0,this.buttonSquare=1,this.buttonCircle=2,this.buttonTriangle=3,this.bumperRight=4,this.bumperLeft=5,this.buttonR2=6,this.buttonL2=7,this.shareButton=8,this.optionsButton=9,this.buttonR3=10,this.buttonL3=11,this.firstShift=12,this.secondShift=13,this.thirdShift=14,this.fourthShift=15,this.fifthShift=16,this.sixthShift=17,this.reverseShift=18,this.buttonPlus=19,this.buttonMinus=20,this.wheelInEnterRight=21,this.wheelInEnterLeft=22,this.enter=23,this.psButton=24,this.buttonsPressed=[];for(var i=0;i<=24;i++)this.buttonsPressed.push(!1);this.wheelAxes=0,this.clutch=1,this.accelerator=2,this.brake=5,this.DPad=9,this.valueDpadUP=-1,this.valueDpadDOWN=.14285719394683838,this.valueDpadLEFT=.7142857313156128,this.valueDpadRIGHT=-.4285714030265808,this.dpadPressed=[];for(var a=0;a<=3;a++)this.dpadPressed.push(!1);this.globalControllerHandler=new A(e)}return Object(u.a)(t,[{key:"checkGamepadChanges",value:function(){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[],e=0;e<t.length;e++)t[e]&&t[e].id.startsWith("G29 Driving Force Racing Wheel")&&(this.gamepad=t[e])}},{key:"checkEvents",value:function(){this.gamepad=null,this.checkGamepadChanges(),null!=this.gamepad&&this.doActionByMapping(),this.globalControllerHandler.updateCar()}},{key:"doActionsPedals",value:function(){var t=Math.pow(this.gamepad.axes[this.clutch],3),e=Math.pow(this.gamepad.axes[this.brake],3);e=1-(e+1)/2;var s=Math.pow(this.gamepad.axes[this.accelerator],3);s=1-(s+1)/2,this.globalControllerHandler.handleAccelerate(t,s),this.globalControllerHandler.handleBrake(t,e)}},{key:"doActionsWheel",value:function(){this.globalControllerHandler.turnDirection(this.gamepad.axes[this.wheelAxes])}},{key:"doActionsDPad",value:function(){if(1.2857143878936768!==this.gamepad.axes[this.DPad])this.gamepad.axes[this.DPad]!==this.valueDpadDOWN||this.dpadPressed[1]?this.gamepad.axes[this.DPad]!==this.valueDpadDOWN&&(this.dpadPressed[1]=!1):this.dpadPressed[1]=!0,this.gamepad.axes[this.DPad]!==this.valueDpadLEFT||this.dpadPressed[2]?this.gamepad.axes[this.DPad]!==this.valueDpadLEFT&&(this.dpadPressed[2]=!1):this.dpadPressed[2]=!0,this.gamepad.axes[this.DPad]!==this.valueDpadRIGHT||this.dpadPressed[3]?this.gamepad.axes[this.DPad]!==this.valueDpadRIGHT&&(this.dpadPressed[3]=!1):this.dpadPressed[3]=!0,this.gamepad.axes[this.DPad]!==this.valueDpadUP||this.dpadPressed[0]?this.gamepad.axes[this.DPad]!==this.valueDpadUP&&(this.dpadPressed[0]=!1):this.dpadPressed[0]=!0;else for(var t=0;t<this.dpadPressed.length;t++)this.dpadPressed[t]=!1}},{key:"doActionsButtons",value:function(){this.gamepad.buttons[this.buttonX].pressed&&!this.buttonsPressed[this.buttonX]?this.buttonsPressed[this.buttonX]=!0:this.gamepad.buttons[this.buttonX].pressed||(this.buttonsPressed[this.buttonX]=!1),this.gamepad.buttons[this.buttonTriangle].pressed&&!this.buttonsPressed[this.buttonTriangle]?this.buttonsPressed[this.buttonTriangle]=!0:this.gamepad.buttons[this.buttonTriangle].pressed||(this.buttonsPressed[this.buttonTriangle]=!1),this.gamepad.buttons[this.buttonCircle].pressed&&!this.buttonsPressed[this.buttonCircle]?this.buttonsPressed[this.buttonCircle]=!0:this.gamepad.buttons[this.buttonCircle].pressed||(this.buttonsPressed[this.buttonCircle]=!1),this.gamepad.buttons[this.buttonSquare].pressed&&!this.buttonsPressed[this.buttonSquare]?this.buttonsPressed[this.buttonSquare]=!0:this.gamepad.buttons[this.buttonSquare].pressed||(this.buttonsPressed[this.buttonSquare]=!1),this.gamepad.buttons[this.psButton].pressed&&!this.buttonsPressed[this.psButton]?this.buttonsPressed[this.psButton]=!0:this.gamepad.buttons[this.psButton].pressed||(this.buttonsPressed[this.psButton]=!1),this.gamepad.buttons[this.buttonPlus].pressed&&!this.buttonsPressed[this.buttonPlus]?this.buttonsPressed[this.buttonPlus]=!0:this.gamepad.buttons[this.buttonPlus].pressed||(this.buttonsPressed[this.buttonPlus]=!1),this.gamepad.buttons[this.buttonMinus].pressed&&!this.buttonsPressed[this.buttonMinus]?this.buttonsPressed[this.buttonMinus]=!0:this.gamepad.buttons[this.buttonMinus].pressed||(this.buttonsPressed[this.buttonMinus]=!1),this.gamepad.buttons[this.buttonL2].pressed&&!this.buttonsPressed[this.buttonL2]?this.buttonsPressed[this.buttonL2]=!0:this.gamepad.buttons[this.buttonL2].pressed||(this.buttonsPressed[this.buttonL2]=!1),this.gamepad.buttons[this.buttonL3].pressed&&!this.buttonsPressed[this.buttonL3]?this.buttonsPressed[this.buttonL3]=!0:this.gamepad.buttons[this.buttonL3].pressed||(this.buttonsPressed[this.buttonL3]=!1),this.gamepad.buttons[this.buttonR2].pressed&&!this.buttonsPressed[this.buttonR2]?(this.globalControllerHandler.turnOnCar(),this.buttonsPressed[this.buttonR2]=!0):this.gamepad.buttons[this.buttonR2].pressed||(this.buttonsPressed[this.buttonR2]=!1),this.gamepad.buttons[this.buttonR3].pressed&&!this.buttonsPressed[this.buttonR3]?this.buttonsPressed[this.buttonR3]=!0:this.gamepad.buttons[this.buttonR3].pressed||(this.buttonsPressed[this.buttonR3]=!1),this.gamepad.buttons[this.enter].pressed&&!this.buttonsPressed[this.enter]?this.buttonsPressed[this.enter]=!0:this.gamepad.buttons[this.enter].pressed||(this.buttonsPressed[this.enter]=!1),this.gamepad.buttons[this.shareButton].pressed&&!this.buttonsPressed[this.shareButton]?this.buttonsPressed[this.shareButton]=!0:this.gamepad.buttons[this.shareButton].pressed||(this.buttonsPressed[this.shareButton]=!1),this.gamepad.buttons[this.optionsButton].pressed&&!this.buttonsPressed[this.optionsButton]?this.buttonsPressed[this.optionsButton]=!0:this.gamepad.buttons[this.optionsButton].pressed||(this.buttonsPressed[this.optionsButton]=!1),this.gamepad.buttons[this.bumperLeft].pressed&&!this.buttonsPressed[this.bumperLeft]?this.buttonsPressed[this.bumperLeft]=!0:this.gamepad.buttons[this.bumperLeft].pressed||(this.buttonsPressed[this.bumperLeft]=!1),this.gamepad.buttons[this.bumperRight].pressed&&!this.buttonsPressed[this.bumperRight]?this.buttonsPressed[this.bumperRight]=!0:this.gamepad.buttons[this.bumperRight].pressed||(this.buttonsPressed[this.bumperRight]=!1),this.gamepad.buttons[this.wheelInEnterLeft].pressed&&!this.buttonsPressed[this.wheelInEnterLeft]?this.buttonsPressed[this.wheelInEnterLeft]=!0:this.gamepad.buttons[this.wheelInEnterLeft].pressed||(this.buttonsPressed[this.wheelInEnterLeft]=!1),this.gamepad.buttons[this.wheelInEnterRight].pressed&&!this.buttonsPressed[this.wheelInEnterRight]?this.buttonsPressed[this.wheelInEnterRight]=!0:this.gamepad.buttons[this.wheelInEnterRight].pressed||(this.buttonsPressed[this.wheelInEnterRight]=!1)}},{key:"doActionsShifter",value:function(){this.gamepad.buttons[this.firstShift].pressed&&!this.buttonsPressed[this.firstShift]?(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],1),this.buttonsPressed[this.firstShift]=!0):!this.gamepad.buttons[this.firstShift].pressed&&this.buttonsPressed[this.firstShift]&&(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],0),this.buttonsPressed[this.firstShift]=!1),this.gamepad.buttons[this.secondShift].pressed&&!this.buttonsPressed[this.secondShift]?(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],2),this.buttonsPressed[this.secondShift]=!0):!this.gamepad.buttons[this.secondShift].pressed&&this.buttonsPressed[this.secondShift]&&(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],0),this.buttonsPressed[this.secondShift]=!1),this.gamepad.buttons[this.thirdShift].pressed&&!this.buttonsPressed[this.thirdShift]?(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],3),this.buttonsPressed[this.thirdShift]=!0):!this.gamepad.buttons[this.thirdShift].pressed&&this.buttonsPressed[this.thirdShift]&&(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],0),this.buttonsPressed[this.thirdShift]=!1),this.gamepad.buttons[this.fourthShift].pressed&&!this.buttonsPressed[this.fourthShift]?(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],4),this.buttonsPressed[this.fourthShift]=!0):!this.gamepad.buttons[this.fourthShift].pressed&&this.buttonsPressed[this.fourthShift]&&(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],0),this.buttonsPressed[this.fourthShift]=!1),this.gamepad.buttons[this.fifthShift].pressed&&!this.buttonsPressed[this.fifthShift]?(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],5),this.buttonsPressed[this.fifthShift]=!0):!this.gamepad.buttons[this.fifthShift].pressed&&this.buttonsPressed[this.fifthShift]&&(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],0),this.buttonsPressed[this.fifthShift]=!1),this.gamepad.buttons[this.sixthShift].pressed&&!this.buttonsPressed[this.sixthShift]?(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],6),this.buttonsPressed[this.sixthShift]=!0):!this.gamepad.buttons[this.sixthShift].pressed&&this.buttonsPressed[this.sixthShift]&&(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],0),this.buttonsPressed[this.sixthShift]=!1),this.gamepad.buttons[this.reverseShift].pressed&&!this.buttonsPressed[this.reverseShift]?(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],-1),this.buttonsPressed[this.reverseShift]=!0):!this.gamepad.buttons[this.reverseShift].pressed&&this.buttonsPressed[this.reverseShift]&&(this.globalControllerHandler.changeShift(this.gamepad.axes[this.clutch],0),this.buttonsPressed[this.reverseShift]=!1)}},{key:"doActionByMapping",value:function(){this.doActionsPedals(),this.doActionsWheel(),this.doActionsDPad(),this.doActionsButtons(),this.doActionsShifter()}}]),t}(),I=function(){function t(){throw Object(c.a)(this,t),new Error("Can not construct singleton. Call get instance instead.")}return Object(u.a)(t,null,[{key:"getInstance",value:function(e){return t.instance||(t.instance=new D(e)),t.instance}}]),t}(),E=s(144).default,L=.1,G=function(){function t(e){Object(c.a)(this,t);var s=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[];this.gamepad=null;for(var n=0;n<s.length;n++)s[n]&&(s[n].id.startsWith("Xbox")||s[n].id.startsWith("xinput"))&&(this.gamepad=s[n]);this.buttonA=0,this.buttonB=1,this.buttonX=2,this.buttonY=3,this.buttonL1=4,this.buttonR1=5,this.buttonL2=6,this.buttonR2=7,this.shareButton=8,this.optionButton=9,this.buttonL3=10,this.buttonR3=11,this.padUp=12,this.padDown=13,this.padLeft=14,this.padRight=15,this.buttomHome=16,this.buttonPressed=[],this.actualShift=0;for(var i=0;i<=16;i++)this.buttonPressed.push(!1);this.xLeftAxe=0,this.yLeftAxe=1,this.xRightAxe=2,this.yRightAxe=3,this.globalControllerHandler=new E(e)}return Object(u.a)(t,[{key:"checkGamepadChanges",value:function(){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[],e=0;e<t.length;e++)t[e]&&t[e].id.startsWith("Xbox")&&(this.gamepad=t[e])}},{key:"checkEvents",value:function(){this.gamepad=null,this.checkGamepadChanges(),null!=this.gamepad&&this.doActionByMapping(),this.globalControllerHandler.updateCar()}},{key:"doActionsAxes",value:function(){if(Math.abs(this.gamepad.axes[this.yLeftAxe]),Math.abs(this.gamepad.axes[this.xLeftAxe])>=L){var t=Math.pow(this.gamepad.axes[this.xLeftAxe],3);this.globalControllerHandler.turnDirection(t)}else this.globalControllerHandler.turnDirection(0);Math.abs(this.gamepad.axes[this.yRightAxe]),Math.abs(this.gamepad.axes[this.xRightAxe])}},{key:"doActionHotKeys",value:function(){this.globalControllerHandler.handleAccelerate(1,this.gamepad.buttons[this.buttonR2].value),this.globalControllerHandler.handleBrake(0,this.gamepad.buttons[this.buttonL2].value)}},{key:"doActionsTriggers",value:function(){this.gamepad.buttons[this.buttonR2].pressed,this.gamepad.buttons[this.buttonL2].pressed}},{key:"doActionsButtons",value:function(){this.gamepad.buttons[this.buttonR1].pressed&&!this.buttonPressed[this.buttonR1]?(this.actualShift<=5&&(this.actualShift+=1,this.globalControllerHandler.changeShift(0,this.actualShift)),this.buttonPressed[this.buttonR1]=!0):this.gamepad.buttons[this.buttonR1].pressed||(this.buttonPressed[this.buttonR1]=!1),this.gamepad.buttons[this.buttonL1].pressed&&!this.buttonPressed[this.buttonL1]?(this.actualShift>=0&&(this.actualShift-=1,this.globalControllerHandler.changeShift(0,this.actualShift)),this.buttonPressed[this.buttonL1]=!0):this.gamepad.buttons[this.buttonL1].pressed||(this.buttonPressed[this.buttonL1]=!1),this.gamepad.buttons[this.shareButton].pressed&&!this.buttonPressed[this.shareButton]?this.buttonPressed[this.shareButton]=!0:this.gamepad.buttons[this.shareButton].pressed||(this.buttonPressed[this.shareButton]=!1),this.gamepad.buttons[this.padUp].pressed&&!this.buttonPressed[this.padUp]?this.buttonPressed[this.padUp]=!0:this.gamepad.buttons[this.padUp].pressed||(this.buttonPressed[this.padUp]=!1),this.gamepad.buttons[this.padDown].pressed&&!this.buttonPressed[this.padDown]?this.buttonPressed[this.padDown]=!0:this.gamepad.buttons[this.padDown].pressed||(this.buttonPressed[this.padDown]=!1),this.gamepad.buttons[this.padLeft].pressed&&!this.buttonPressed[this.padLeft]?this.buttonPressed[this.padLeft]=!0:this.gamepad.buttons[this.padLeft].pressed||(this.buttonPressed[this.padLeft]=!1),this.gamepad.buttons[this.padRight].pressed&&!this.buttonPressed[this.padRight]?this.buttonPressed[this.padRight]=!0:this.gamepad.buttons[this.padRight].pressed||(this.buttonPressed[this.padRight]=!1),this.gamepad.buttons[this.buttonA].pressed&&!this.buttonPressed[this.buttonA]?this.buttonPressed[this.buttonA]=!0:this.gamepad.buttons[this.buttonA].pressed||(this.buttonPressed[this.buttonA]=!1),this.gamepad.buttons[this.buttonB].pressed&&!this.buttonPressed[this.buttonB]?this.buttonPressed[this.buttonB]=!0:this.gamepad.buttons[this.buttonB].pressed||(this.buttonPressed[this.buttonB]=!1),this.gamepad.buttons[this.buttonY].pressed&&!this.buttonPressed[this.buttonY]?this.buttonPressed[this.buttonY]=!0:this.gamepad.buttons[this.buttonY].pressed||(this.buttonPressed[this.buttonY]=!1),this.gamepad.buttons[this.buttonX].pressed&&!this.buttonPressed[this.buttonX]?this.buttonPressed[this.buttonX]=!0:this.gamepad.buttons[this.buttonX].pressed||(this.buttonPressed[this.buttonX]=!1),this.gamepad.buttons[this.buttonR3].pressed&&!this.buttonPressed[this.buttonR3]?this.buttonPressed[this.buttonR3]=!0:this.gamepad.buttons[this.buttonR3].pressed||(this.buttonPressed[this.buttonR3]=!1),this.gamepad.buttons[this.buttonL3].pressed&&!this.buttonPressed[this.buttonL3]?this.buttonPressed[this.buttonL3]=!0:this.gamepad.buttons[this.buttonL3].pressed||(this.buttonPressed[this.buttonL3]=!1),this.gamepad.buttons[this.padUp].pressed&&!this.buttonPressed[this.padUp]?this.buttonPressed[this.padUp]=!0:this.gamepad.buttons[this.padUp].pressed||(this.buttonPressed[this.padUp]=!1),this.gamepad.buttons[this.padDown].pressed&&!this.buttonPressed[this.padDown]?this.buttonPressed[this.padDown]=!0:this.gamepad.buttons[this.padDown].pressed||(this.buttonPressed[this.padDown]=!1),this.gamepad.buttons[this.padLeft].pressed&&!this.buttonPressed[this.padLeft]?this.buttonPressed[this.padLeft]=!0:this.gamepad.buttons[this.padLeft].pressed||(this.buttonPressed[this.padLeft]=!1),this.gamepad.buttons[this.padRight].pressed&&!this.buttonPressed[this.padRight]?this.buttonPressed[this.padRight]=!0:this.gamepad.buttons[this.padRight].pressed||(this.buttonPressed[this.padRight]=!1),this.gamepad.buttons[this.buttomHome].pressed&&!this.buttonPressed[this.buttomHome]?(this.globalControllerHandler.changeShiftBox("semi-auto"),this.buttonPressed[this.buttomHome]=!0):this.gamepad.buttons[this.buttomHome].pressed||(this.buttonPressed[this.buttomHome]=!1),this.gamepad.buttons[this.optionButton].pressed&&!this.buttonPressed[this.optionButton]?(this.globalControllerHandler.turnOnCar(),this.buttonPressed[this.optionButton]=!0):this.gamepad.buttons[this.optionButton].pressed||(this.buttonPressed[this.optionButton]=!1)}},{key:"doActionByMapping",value:function(){this.doActionHotKeys(),this.doActionsAxes(),this.doActionsTriggers(),this.doActionsButtons()}}]),t}(),B=function(){function t(){throw Object(c.a)(this,t),new Error("Can not construct singleton. Call get instance instead.")}return Object(u.a)(t,null,[{key:"getInstance",value:function(e){return t.instance||(t.instance=new G(e)),t.instance}}]),t}(),H=function(){function t(){Object(c.a)(this,t),this.observers=[]}return Object(u.a)(t,[{key:"attachObserver",value:function(t){this.observers.push(t)}},{key:"removeObserver",value:function(t){var e=this.observers.indexOf(t);e>-1&&this.observers.splice(e,1)}},{key:"notifyObservers",value:function(t){for(var e=0;e<this.observers.length;e++)this.observers[e].update(t)}}]),t}(),N=s(204),W=s.n(N),_=function(){function t(){throw Object(c.a)(this,t),new Error("Can not construct singleton. Call get instance instead.")}return Object(u.a)(t,null,[{key:"getInstance",value:function(){var e=Object(h.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.AmmoInstanceToReturn){e.next=4;break}return e.next=3,W()();case 3:t.AmmoInstanceToReturn=e.sent;case 4:return e.abrupt("return",t.AmmoInstanceToReturn);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),t}();_.AmmoInstanceToReturn=null;var V=function(){function t(e,s,n,i,a,r,o){Object(c.a)(this,t),this.position=e,this.quaternion=s,this.inertia=n,this.mass=i,this.shape=a,this.physicsWorld=r,this.friction=o}return Object(u.a)(t,[{key:"buildAmmoPhysics",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e,s,n,i,a,r;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.getInstance();case 2:e=t.sent,this.inertia=new e.btVector3(this.inertia.x,this.inertia.y,this.inertia.z),this.Ammo=e,(s=new e.btTransform).setIdentity(),s.setOrigin(new e.btVector3(this.position.x,this.position.y,this.position.z)),s.setRotation(new e.btQuaternion(this.quaternion.x,this.quaternion.y,this.quaternion.z,this.quaternion.w)),this.tempTransform=new e.btTransform,n=new e.btDefaultMotionState(s),(i=new e.btBoxShape(new e.btVector3(this.shape.x/2,this.shape.y/2,this.shape.z/2))).calculateLocalInertia(this.mass,this.inertia),a=new e.btRigidBodyConstructionInfo(this.mass,n,i,this.inertia),this.rigidBody=new e.btRigidBody(a),this.rigidBody.setFriction(this.friction),this.rigidBody.setRollingFriction(10*this.friction),this.physicsWorld.addRigidBody(this.rigidBody),this.tuning=new this.Ammo.btVehicleTuning,r=new this.Ammo.btDefaultVehicleRaycaster(this.physicsWorld),this.vehicle=new this.Ammo.btRaycastVehicle(this.tuning,this.rigidBody,r),this.vehicle.setCoordinateSystem(0,1,2),this.physicsWorld.addAction(this.vehicle),.35,.85,-1.45,.35,.35,-.85,.2,1.65,.85,.2,.35,.35,this.addWheel(!0,new this.Ammo.btVector3(.85,.2,1.65),.35,.35,0,1),this.addWheel(!0,new this.Ammo.btVector3(-.85,.2,1.65),.35,.35,1,-1),this.addWheel(!1,new this.Ammo.btVector3(.85,.2,-1.45),.35,.35,2,1),this.addWheel(!1,new this.Ammo.btVector3(-.85,.2,-1.45),.35,.35,3,-1),this.mass>0&&this.rigidBody.setActivationState(4);case 40:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"addWheel",value:function(t,e,s,n,i,a){var r=new this.Ammo.btVector3(0,-1,0),o=new this.Ammo.btVector3(-1,0,0),h=this.vehicle.addWheel(e,r,o,.6,s,this.tuning,t);h.set_m_suspensionStiffness(2),h.set_m_wheelsDampingRelaxation(3.3),h.set_m_wheelsDampingCompression(4.4),h.set_m_frictionSlip(1e3),h.set_m_rollInfluence(.2)}},{key:"updatePhysics",value:function(){for(var t={chassis:{position:null,rotation:null},wheels:[]},e=0;e<this.vehicle.getNumWheels();e++){this.vehicle.updateWheelTransform(e,!0);var s=this.vehicle.getWheelTransformWS(e),n=s.getOrigin(),i=s.getRotation();t.wheels.push({position:new b.Gb(n.x(),n.y(),n.z()),rotation:new b.Hb(i.x(),i.y(),i.z(),i.w())})}var a=this.vehicle.getChassisWorldTransform(),r=a.getOrigin(),o=a.getRotation();return t.chassis={position:new b.Gb(r.x(),r.y(),r.z()),rotation:new b.Hb(o.x(),o.y(),o.z(),o.w())},t}},{key:"getRigidBody",value:function(){return this.rigidBody}},{key:"setEngineForce",value:function(t){this.vehicle.applyEngineForce(t,2),this.vehicle.applyEngineForce(t,3)}},{key:"brake",value:function(t){var e=Math.abs(this.vehicle.getCurrentSpeedKmHour()),s=100/e;0===e&&(s=0),t+=s,this.vehicle.setBrake(t/2,0),this.vehicle.setBrake(t/2,1),this.vehicle.setBrake(t,2),this.vehicle.setBrake(t,3)}},{key:"setSteeringRotation",value:function(t){this.vehicle.setSteeringValue(-.5*t,0),this.vehicle.setSteeringValue(-.5*t,1)}},{key:"getVelocity",value:function(){return this.vehicle.getCurrentSpeedKmHour()}}]),t}(),F=8e3,z=200,U=function(){function t(){Object(c.a)(this,t)}return Object(u.a)(t,[{key:"changeValueInRPMCurve",value:function(t,e,s,n){var i;e?i=2*(t-s/F):i=1.5*-t;return(n+=i)>600?n=600:n<0&&(n=0),[s=F*(1-Math.exp(-n/z)),n]}}]),t}(),X=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(u.a)(s,[{key:"accelerate",value:function(t,e,s){return this.changeValueInRPMCurve(0,!0,e,s)}},{key:"brake",value:function(t,e,s){return this.changeValueInRPMCurve(t,!1,e,s)}}]),s}(U),q=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(u.a)(s,[{key:"accelerate",value:function(t,e,s){return this.changeValueInRPMCurve(t,!0,e,s)}},{key:"brake",value:function(t,e,s){return this.changeValueInRPMCurve(t,!1,e,s)}}]),s}(U),J=function(){function t(){Object(c.a)(this,t),this.engineState=new X,this.currentRPM=0,this.currentXInRPMCurve=0}return Object(u.a)(t,[{key:"turnOn",value:function(){this.engineState=new q}},{key:"clutchIsPressed",value:function(t){return t<=.25}},{key:"handleEngineShutdown",value:function(t,e){e.shutDownEngine(t,this.currentRPM)&&this.engineState instanceof q&&(this.engineState=new X)}},{key:"isInConditionToAccelerate",value:function(t){return this.currentRPM>=0&&!this.clutchIsPressed(t)||this.clutchIsPressed(t)}},{key:"engineCanApplyForce",value:function(t){return this.currentRPM>=0&&!this.clutchIsPressed(t)}},{key:"accelerate",value:function(t,e,s){var n=this.engineState.accelerate(e,this.currentRPM,this.currentXInRPMCurve);this.currentRPM=n[0],this.currentXInRPMCurve=n[1],this.handleEngineShutdown(t,s)}},{key:"brake",value:function(t,e,s){var n=this.engineState.brake(e,this.currentRPM,this.currentXInRPMCurve);this.currentRPM=n[0],this.currentXInRPMCurve=n[1],this.handleEngineShutdown(t,s)}},{key:"changeRPM",value:function(t){this.currentRPM=t,-this.currentRPM/F+1>0?(this.currentXInRPMCurve=-Math.log(-this.currentRPM/F+1)*z,this.currentXInRPMCurve<0&&(this.currentXInRPMCurve=0)):this.currentRPM===F&&(this.currentXInRPMCurve=600)}},{key:"getCurrentRPM",value:function(){return this.currentRPM}}]),t}(),Y=function(){function t(e){Object(c.a)(this,t),this.NEUTRAL=0,this.REVERSE=-1,this.FIRST=1,this.SECOND=2,this.THIRD=3,this.FOURTH=4,this.FIFTH=5,this.SIXTH=6,this.validShifts=[this.REVERSE,this.NEUTRAL,this.FIRST,this.SECOND,this.THIRD,this.FOURTH,this.FIFTH,this.SIXTH],this.currentShift=this.NEUTRAL,this.carEngine=e,this.minimumVelocityOnShift=[0,10,20,35,60,90],this.maximumVelocityOnShift=[40,60,80,110,140,200]}return Object(u.a)(t,[{key:"isValidShift",value:function(t){if(this.validShifts.indexOf(t)>=0)return!0;throw new Error("Shift "+t+" is not valid.")}},{key:"calculateNormalFactorRPM",value:function(t,e){return(e-this.minimumVelocityOnShift[Math.abs(t)-1])/(this.maximumVelocityOnShift[Math.abs(t)-1]-this.minimumVelocityOnShift[Math.abs(t)-1])}},{key:"getValueForNewRPM",value:function(t,e){if(t===this.NEUTRAL||Math.abs(t)===this.FIRST&&Math.abs(e)<5)return this.carEngine.getCurrentRPM();if(t===this.REVERSE&&e>0)return 0;if(t>0&&e<0)return 0;var s=this.calculateNormalFactorRPM(t,e);if(s>1)return F;var n=s*z;return F*(1-Math.exp(-n/z))}},{key:"clutchIsPressed",value:function(t){return t<=-.75}},{key:"shutDownEngine",value:function(){return!1}},{key:"getEngineForce",value:function(t,e){t=Math.abs(t);var s=this.carEngine.getCurrentRPM();if(this.currentShift===this.NEUTRAL)return 0;var n=(e+1)/2,i=this.minimumVelocityOnShift[Math.abs(this.currentShift)-1]*(1-Math.exp(3*-n)),a=(t-i)/(this.maximumVelocityOnShift[Math.abs(this.currentShift)-1]-i),r=Math.pow(1-a,2);return r>1&&(r=0),6/this.currentShift*s*r}},{key:"changeShift",value:function(){}},{key:"getCurrentShift",value:function(){return this.currentShift}}]),t}(),Q=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(u.a)(s,[{key:"changeShift",value:function(t,e,s){if(!this.isValidShift(e)||!this.clutchIsPressed(t))throw new Error("Can't change shift if clutch is not pressed");this.currentShift=e,this.carEngine.changeRPM(this.getValueForNewRPM(e,s,t))}},{key:"shutDownEngine",value:function(t,e){return!this.clutchIsPressed(t)&&e<1e3}}]),s}(Y),Z=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(u.a)(s,[{key:"changeShift",value:function(t,e,s){this.isValidShift(e)&&(this.currentShift=e,this.carEngine.changeRPM(this.getValueForNewRPM(e,s,t)))}}]),s}(Y),K=[0,0,0],$=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this)).carEngine=new J,n.shiftBox=new Z(n.carEngine),n.currentDirectionTurn=0,n.currentTireRotation=0,n.position=new b.Gb(K[0],K[1],K[2]),n.rotationQuaternion=new b.Hb(0,0,0,1),n.mass=1e3,n.physicsShape=new b.Gb(2,1.3,5),n.rotation=new b.Hb(0,0,0,1),n.inertia=new b.Gb(1,0,1),n.carPhysics=new V(n.position,n.rotationQuaternion,n.inertia,n.mass,n.physicsShape,t,0),n.carPhysics.buildAmmoPhysics(),n}return Object(u.a)(s,[{key:"accelerate",value:function(t,e){this.carEngine.accelerate(t,e,this.shiftBox),e>.1&&this.carEngine.engineCanApplyForce(t)?this.carPhysics.setEngineForce(this.shiftBox.getEngineForce(this.carPhysics.getVelocity(),t)):this.carPhysics.setEngineForce(0)}},{key:"brake",value:function(t,e){this.carEngine.brake(t,e,this.shiftBox),this.carPhysics.brake(300*e)}},{key:"changeShift",value:function(t,e){this.shiftBox.changeShift(t,e,this.carPhysics.getVelocity())}},{key:"turnOnRightLight",value:function(){}},{key:"turnOnLeftLight",value:function(){}},{key:"turnOnCar",value:function(){this.carEngine.turnOn()}},{key:"turnDirection",value:function(t){this.currentTireRotation=t,this.carPhysics.setSteeringRotation(t)}},{key:"update",value:function(){var t=this.carPhysics.updatePhysics();this.position=t.chassis.position,this.rotation=t.chassis.rotation,this.wheelsData=t.wheels,Object(j.a)(Object(y.a)(s.prototype),"notifyObservers",this).call(this,this.getDataToAnimate())}},{key:"getLastRotation",value:function(){return this.currentTireRotation}},{key:"getDataToAnimate",value:function(){return{direction:this.currentDirectionTurn,velocity:this.carPhysics.getVelocity(),lastRotationWheel:this.currentTireRotation,position:this.position,rotation:this.rotation,physicsBody:this.carPhysics,wheelsData:this.wheelsData,rpm:this.getCurrentRPM()}}},{key:"getSpeed",value:function(){return this.carPhysics.getVelocity()}},{key:"getCurrentRPM",value:function(){return this.carEngine.getCurrentRPM()}},{key:"changeShiftBox",value:function(t){"semi-auto"===t?this.shiftBox=new Z(this.carEngine):"manual"===t&&(this.shiftBox=new Q(this.carEngine))}},{key:"getCurrentShift",value:function(){return this.shiftBox.getCurrentShift()}}]),s}(H),tt=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(t,n,i,a,r,o,h){var u;return Object(c.a)(this,s),(u=e.call(this)).position=t,u.quaternion=n,u.inertia=i,u.mass=a,u.shape=r,u.physicsWorld=o,h||(h=1),u.friction=h,u}return Object(u.a)(s,[{key:"generateShape",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(){return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",null);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"buildAmmoPhysics",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e,s,n,i,a;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.getInstance();case 2:return e=t.sent,this.inertia=new e.btVector3(this.inertia.x,this.inertia.y,this.inertia.z),this.Ammo=e,(s=new e.btTransform).setIdentity(),s.setOrigin(new e.btVector3(this.position.x,this.position.y,this.position.z)),s.setRotation(new e.btQuaternion(this.quaternion.x,this.quaternion.y,this.quaternion.z,this.quaternion.w)),this.tempTransform=new e.btTransform,n=new e.btDefaultMotionState(s),t.next=13,this.generateShape();case 13:(i=t.sent).setMargin(.05),i.calculateLocalInertia(this.mass,this.inertia),a=new e.btRigidBodyConstructionInfo(this.mass,n,i,this.inertia),this.rigidBody=new e.btRigidBody(a),this.rigidBody.setFriction(this.friction),this.rigidBody.setRollingFriction(2*this.friction),this.physicsWorld.addRigidBody(this.rigidBody),this.mass>0&&this.rigidBody.setActivationState(4);case 22:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"updatePhysics",value:function(){var t=this.rigidBody.getMotionState();if(t){t.getWorldTransform(this.tempTransform);var e=this.tempTransform.getOrigin(),s=this.tempTransform.getRotation(),n={position:new b.Gb(e.x(),e.y(),e.z()),rotation:new b.Hb(s.x(),s.y(),s.z(),s.w())};return this.notifyObservers(n),n}throw new Error("No motion state found in rigid body")}},{key:"setLinearVelocity",value:function(t){var e=new this.Ammo.btVector3(this.mass*t.x,this.mass*t.y,this.mass*t.z);this.rigidBody.applyForce(e)}},{key:"getRigidBody",value:function(){return this.rigidBody}}]),s}(H),et=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(u.a)(s,[{key:"generateShape",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.getInstance();case 2:return e=t.sent,t.abrupt("return",new e.btCylinderShape(new e.btVector3(this.shape.x,this.shape.y,this.shape.z)));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),s}(tt),st=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).pathToTexture=t,n.RADIUS_TOP=.1,n.RADIUS_BOTTOM=.8,n.HEIGHT=1.25,n.observedState=null,n}return Object(u.a)(s,[{key:"animate",value:function(){null!=this.observedState&&(this.threeDModel.position.set(this.observedState.position.x,this.observedState.position.y,this.observedState.position.z),this.threeDModel.quaternion.set(this.observedState.rotation.x,this.observedState.rotation.y,this.observedState.rotation.z,this.observedState.rotation.w))}},{key:"addToScene",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(e,s,n,i){var a,r,h,c,u,l,d;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.threeDModel||(a=new b.l(this.RADIUS_TOP,this.RADIUS_BOTTOM,this.HEIGHT,32,void 0,!0),r=(new b.Ab).load(this.pathToTexture),h=new b.S({map:r}),c=new b.S({color:13984548}),u=new b.e(2*this.RADIUS_BOTTOM,.1,2*this.RADIUS_BOTTOM),(l=new b.R(u,c)).position.set(0,-this.HEIGHT/2,0),(d=new b.R(a,h)).position.set(0,0,0),this.threeDModel=new b.u,this.threeDModel.add(d).add(l),this.threeDModel.name=s,this.threeDModel.position.set(n[0],n[1],n[2]),this.threeDModel.scale.set(i[0],i[1],i[2]),this.RADIUS_TOP*=i[0],this.RADIUS_BOTTOM*=i[0],this.HEIGHT*=i[1],e.add(this.threeDModel)),t.abrupt("return",this);case 2:case"end":return t.stop()}}),t,this)})));return function(e,s,n,i){return t.apply(this,arguments)}}()}]),s}(x),nt=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(u.a)(s,[{key:"generateShape",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.getInstance();case 2:return e=t.sent,t.abrupt("return",new e.btBoxShape(new e.btVector3(this.shape.x/2,this.shape.y/2,this.shape.z/2)));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),s}(tt),it=function(){function t(e,s,n){Object(c.a)(this,t),this.scene=s,this.physicsWorld=n,this.physicsToUpdate=[],this.objectsToAnimate=[],0===e&&this.createLevel0()}return Object(u.a)(t,[{key:"updatePhysics",value:function(){this.physicsToUpdate.forEach((function(t){t.updatePhysics()}))}},{key:"animate",value:function(){this.objectsToAnimate.forEach((function(t){t.animate()}))}},{key:"createRectangle",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(e,s,n,i,a,r,h){var c,u,l,d,p,f,v,g,m=arguments;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=m.length>7&&void 0!==m[7]?m[7]:null,(u=(new b.Ab).load(r)).wrapS=b.nb,u.wrapT=b.nb,u.repeat.set(s,i),l=new b.W({map:u,side:b.n}),c&&((d=(new b.Ab).load(c)).repeat.set(s,i),d.wrapS=b.nb,d.wrapT=b.nb,l.normalMap=d,l.normalScale.set(10,10)),(p=new b.e(s,n,i)).rotateX(a),(f=new b.lb).setFromAxisAngle(new b.Gb(1,0,0),a),v=new nt(new b.Gb(e[0],e[1],e[2]),f,new h.btVector3(0,0,0),0,new b.Gb(s,n,i),this.physicsWorld,1e3),t.next=14,v.buildAmmoPhysics();case 14:this.physicsToUpdate.push(v),(g=new b.R(p,l)).position.set(e[0],e[1],e[2]),this.scene.add(g);case 18:case"end":return t.stop()}}),t,this)})));return function(e,s,n,i,a,r,o){return t.apply(this,arguments)}}()},{key:"createCone",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(e,s){var n,i;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new st("textures/coneTexture.jpg")).addToScene(this.scene,"trafficCone",e,[.5,.5,.5]),i=new et(new b.Gb(e[0],e[1],e[2]),(new b.lb).setFromAxisAngle(new b.Gb(1,0,0),0),new s.btVector3(0,0,0),10,new b.Gb(n.RADIUS_BOTTOM,n.HEIGHT/2,n.RADIUS_BOTTOM),this.physicsWorld,1e3),t.next=5,i.buildAmmoPhysics();case 5:this.physicsToUpdate.push(i),i.attachObserver(n),this.objectsToAnimate.push(n);case 8:case"end":return t.stop()}}),t,this)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"createLevel0",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.getInstance();case 2:e=t.sent,this.createRectangle([10,0,10],10,2,10,-Math.PI/8,"textures/pavimento.jpg",e,"textures/pavimento_map.png"),this.createRectangle([-10,0,10],10,2,10,-Math.PI/4,"textures/pavimento.jpg",e,"textures/pavimento_map.png"),this.createRectangle([0,0,0],100,.1,100,0,"textures/pavimento.jpg",e,"textures/pavimento_map.png"),this.createCone([0,.5,10],e),this.createCone([0,.5,30],e),this.createCone([0,.5,20],e);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),at=function(){function t(){Object(c.a)(this,t)}return Object(u.a)(t,null,[{key:"createButton",value:function(e){var s=document.createElement("button");function n(){s.style.display="",s.style.cursor="auto",s.style.left="calc(50% - 75px)",s.style.width="150px",s.onmouseenter=null,s.onmouseleave=null,s.onclick=null}function i(t){t.style.position="absolute",t.style.bottom="20px",t.style.padding="12px 6px",t.style.border="1px solid #fff",t.style.borderRadius="4px",t.style.background="rgba(0,0,0,0.1)",t.style.color="#fff",t.style.font="normal 13px sans-serif",t.style.textAlign="center",t.style.opacity="0.5",t.style.outline="none",t.style.zIndex="999"}if("xr"in navigator)return s.id="VRButton",s.style.display="none",i(s),navigator.xr.isSessionSupported("immersive-vr").then((function(i){i?function(){var t=null;function n(t){return i.apply(this,arguments)}function i(){return(i=Object(h.a)(Object(o.a)().mark((function n(i){return Object(o.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i.addEventListener("end",a),n.next=3,e.xr.setSession(i);case 3:s.textContent="EXIT VR",t=i;case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function a(){t.removeEventListener("end",a),s.textContent="ENTER VR",t=null}s.style.display="",s.style.cursor="pointer",s.style.left="calc(50% - 50px)",s.style.width="100px",s.textContent="ENTER VR",s.onmouseenter=function(){s.style.opacity="1.0"},s.onmouseleave=function(){s.style.opacity="0.5"},s.onclick=function(){null===t?(navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]}).then(n),localStorage.setItem("VR",!0)):t.end()}}():(n(),s.textContent="VR NOT SUPPORTED"),i&&t.xrSessionIsGranted&&s.click()})).catch((function(t){n(),console.warn("Exception when trying to call xr.isSessionSupported",t),s.textContent="VR NOT ALLOWED"})),s;var a=document.createElement("a");return!1===window.isSecureContext?(a.href=document.location.href.replace(/^http:/,"https:"),a.innerHTML="WEBXR NEEDS HTTPS"):(a.href="https://immersiveweb.dev/",a.innerHTML="WEBXR NOT AVAILABLE"),a.style.left="calc(50% - 90px)",a.style.width="180px",a.style.textDecoration="none",i(a),a}},{key:"registerSessionGrantedListener",value:function(){if("xr"in navigator){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",(function(){t.xrSessionIsGranted=!0}))}}}]),t}();at.xrSessionIsGranted=!1,at.registerSessionGrantedListener();var rt=s(2),ot=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){var t;return Object(c.a)(this,s),(t=e.call(this)).state={currentRPM:0,velocity:0,currentShift:0},t.physicsToUpdate=[],localStorage.setItem("VR",!1),t.gotAnyEvent=!1,t}return Object(u.a)(s,[{key:"componentDidMount",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e,s;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.objectsToAnimate=[],this.scene=new b.ob,this.renderer=new b.Kb({alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(8900346,1),this.renderer.outputEncoding=b.Lb,this.camera=new f(this.renderer),this.camera.addContainerToScene(this.scene),this.clock=new b.i,t.next=11,this.createAmmo();case 11:return this.ambientLight=new b.a(16777215,1),this.scene.add(this.ambientLight),this.sunLight=new b.m(16777215,1),this.sunLight.position.set(0,100,0),this.scene.add(this.sunLight),t.next=18,_.getInstance();case 18:return e=t.sent,this.level=new it(0,this.scene,this.physicsWorld),this.physicsToUpdate.push(this.level),this.objectsToAnimate.push(this.level),this.cone=new st("textures/coneTexture.jpg"),this.cone.addToScene(this.scene,"trafficCone",[10,0,0],[1,1,1]),this.conePhysics=new et(new b.Gb(10,0,0),(new b.lb).setFromAxisAngle(new b.Gb(1,0,0),0),new e.btVector3(0,0,0),10,new b.Gb(this.cone.RADIUS_BOTTOM,this.cone.HEIGHT/2,this.cone.RADIUS_BOTTOM),this.physicsWorld,1e3),t.next=27,this.conePhysics.buildAmmoPhysics();case 27:return this.physicsToUpdate.push(this.conePhysics),this.conePhysics.attachObserver(this.cone),this.objectsToAnimate.push(this.cone),this.carLogic=new $(this.physicsWorld),s=new C,this.carLogic.attachObserver(s),this.carLogic.attachObserver(this.camera),t.t0=this.objectsToAnimate,t.next=37,s.addToScene(this.scene);case 37:t.t1=t.sent,t.t0.push.call(t.t0,t.t1),this.carLogic.notifyObservers(),this.animation=this.animation.bind(this),this.handleWindowResize=this.handleWindowResize.bind(this),this.generateEvents=this.generateEvents.bind(this),this.generateEvents(),this.mount.appendChild(this.renderer.domElement),this.animation(),document.body.appendChild(at.createButton(this.renderer)),this.renderer.xr.enabled=!0;case 48:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"generateEvents",value:function(){var t=this;window.addEventListener("resize",this.handleWindowResize),window.addEventListener("gamepaddisconnected",(function(t){I.removeInstance()})),document.addEventListener("keydown",(function(e){var s=e.key;switch(t.carLogic.removeObserver(t.camera),s){case"1":t.camera=new f(t.renderer),t.camera.addContainerToScene(t.scene);break;case"2":t.camera=new m(t.renderer);break;case"3":t.camera=new v(new b.Gb(-4.35,.6,-.1));break;case"4":t.camera=new v(new b.Gb(4.35,.6,-.1));break;case"5":t.camera=new v(new b.Gb(0,3,-5))}t.carLogic.attachObserver(t.camera),t.carLogic.notifyObservers()}),!1)}},{key:"createAmmo",value:function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e,s,n,i,a;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.getInstance();case 2:e=t.sent,this.tempTransform=new e.btTransform,s=new e.btDefaultCollisionConfiguration,n=new e.btCollisionDispatcher(s),i=new e.btDbvtBroadphase,a=new e.btSequentialImpulseConstraintSolver,this.physicsWorld=new e.btDiscreteDynamicsWorld(n,i,a,s),this.physicsWorld.setGravity(new e.btVector3(0,-9.8,0));case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handleWindowResize",value:function(){this.camera.handleResize(),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.render(this.scene,this.camera.getCameraInstance())}},{key:"animation",value:function(){var t=this.clock.getDelta();this.renderer.setAnimationLoop(this.animation),this.physicsWorld.stepSimulation(t,10),this.objectsToAnimate.forEach((function(t){t.animate()})),this.physicsToUpdate.forEach((function(t){t.updatePhysics()})),this.camera.setPositionRelativeToObject(),B.getInstance(this.carLogic).checkEvents(),this.setState({velocity:this.carLogic.getSpeed(),currentRPM:this.carLogic.getCurrentRPM(),currentShift:this.carLogic.getCurrentShift()}),this.renderer.render(this.scene,this.camera.getCameraInstance())}},{key:"render",value:function(){var t=this;return Object(rt.jsxs)("div",{children:[Object(rt.jsx)("div",{style:{position:"absolute",left:"10px",top:"10px",color:"red"},id:"Acelerador",children:Object(rt.jsxs)("p",{style:{zIndex:20,display:"float",fontWeight:"bold"},children:["Cambio Actual: ",parseInt(this.state.currentShift)]})}),Object(rt.jsx)("div",{ref:function(e){t.mount=e}})]})}}]),s}(n.Component),ht=s(18),ct={width:"100vw",height:"100vh",backgroundImage:'url("DrivingSimMenuNoTitle.png")',backgroundSize:"cover",backgroundRepeat:"no-repeat"},ut=function(){var t=Object(ht.m)();return Object(rt.jsx)(rt.Fragment,{children:Object(rt.jsx)("div",{style:ct,children:Object(rt.jsxs)("div",{id:"button-box",style:{position:"absolute",top:"5%",right:"5%"},children:[Object(rt.jsx)("div",{className:"MainMenuTitle",children:Object(rt.jsxs)("h1",{style:{textAlign:"center",fontSize:"7rem"},children:["Driving",Object(rt.jsx)("br",{}),"Simulator"]})}),Object(rt.jsx)("div",{className:"buttonWrapperMainMenu",children:Object(rt.jsx)("button",{className:"buttonMainMenu",onClick:function(){return t("/scene")},children:"Iniciar"})}),Object(rt.jsx)("div",{className:"buttonWrapperMainMenu",children:Object(rt.jsx)("button",{className:"buttonMainMenu",onClick:function(){return t("/level-editor")},children:"Editor de Niveles"})}),Object(rt.jsx)("div",{className:"buttonWrapperMainMenu",children:Object(rt.jsx)("button",{className:"buttonMainMenu",onClick:function(){return t("/configs")},children:"Configuraci\xf3n"})})]})})})},lt=s(21),dt=s(12),bt=s(397),pt=s(43),ft=s(391),vt=s(14),gt=s(392),mt=s(396),jt=s(208),yt=s.n(jt),wt=function(t){var e=t.openConfigs,s=t.handleDrawerClose,n=i.a.useState(!1),a=Object(dt.a)(n,2),r=a[0],o=a[1];i.a.useEffect((function(){o(e)}),[e]);var h=Object(vt.a)("div")((function(t){var e=t.theme;return Object(pt.a)(Object(pt.a)({display:"flex",alignItems:"center",width:"100%",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-start"})}));return Object(rt.jsx)(rt.Fragment,{children:Object(rt.jsx)(ft.a,{children:Object(rt.jsxs)(gt.a,{sx:{width:window.innerWidth/6,flexShrink:0,"& .MuiDrawer-paper":{width:window.innerWidth/6,boxSizing:"border-box"}},variant:"persistent",anchor:"right",open:r,children:[Object(rt.jsxs)(h,{className:"drawer-header",onClick:s,children:[Object(rt.jsx)(yt.a,{}),Object(rt.jsx)("div",{style:{width:"100%"},children:Object(rt.jsx)("h3",{style:{textAlign:"right",paddingRight:30},children:"Configurations"})})]}),Object(rt.jsx)(mt.a,{})]})})})},Ot=s(209),xt=s.n(Ot),St=Object(n.createContext)(),Pt={cone:null,trapecio:null,street:null},Rt=function(t){var e=t.openItems,s=t.handleDrawerClose,n=i.a.useState(!1),a=Object(dt.a)(n,2),r=a[0],o=a[1],h=i.a.useContext(St),c=h.setLastSelectedItem,u=h.lastSelectedItem;i.a.useEffect((function(){o(e)}),[e]);var l=Object(vt.a)("div")((function(t){var e=t.theme;return Object(pt.a)(Object(pt.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"})})),d=i.a.useState(Pt),b=Object(dt.a)(d,2),p=b[0],f=b[1];return Object(rt.jsx)(rt.Fragment,{children:Object(rt.jsx)(ft.a,{children:Object(rt.jsxs)(gt.a,{sx:{width:window.innerWidth/6,flexShrink:0,"& .MuiDrawer-paper":{width:window.innerWidth/6,boxSizing:"border-box"}},variant:"persistent",anchor:"left",open:r,children:[Object(rt.jsxs)(l,{onClick:s,className:"drawer-header",children:[Object(rt.jsx)("div",{style:{width:"100%"},children:Object(rt.jsx)("h3",{style:{textAlign:"left",paddingLeft:10},children:"Items"})}),Object(rt.jsx)(xt.a,{})]}),Object(rt.jsx)(mt.a,{}),Object(rt.jsx)(ft.a,{style:{justifyContent:"center",display:"flex",alignItems:"center",flexDirection:"column"},children:Object.entries(p).map((function(t){var e=Object(dt.a)(t,2),s=e[0],n=e[1];return Object(rt.jsx)("img",{alt:"".concat(s),src:"".concat(s,".png"),width:75,height:75,className:"imageLevelEditor ".concat(n),onClick:function(){return function(t){var e=Object(pt.a)({},Pt);e[t]="selected",f(e),c({selectedItem:t,scale:1,positionX:0,positionY:0,zIndex:u?u.zIndex+1:1})}(s)}},s)}))})]})})})},kt=s(212),Mt=s.n(kt),Tt=s(211),Ct=s.n(Tt),At=s(394),Dt=function(t){var e=t.setGridDimensions,s=t.gridDimensions,i=Object(n.useState)(s.width),a=Object(dt.a)(i,2),r=a[0],o=a[1],h=Object(n.useState)(s.height),c=Object(dt.a)(h,2),u=c[0],l=c[1];return Object(rt.jsxs)(ft.a,{container:!0,direction:"row",width:"80%",marginLeft:"10%",justifyContent:"space-evenly",alignItems:"center",spacing:2,children:[Object(rt.jsxs)(ft.a,{item:!0,xs:2,children:[Object(rt.jsx)("p",{children:"Ancho:"}),Object(rt.jsx)("input",{value:r,type:"number",step:"1",onChange:function(t){var e=parseInt(t.target.value.replaceAll(",","").replaceAll(".",""));o(e>40?40:e)}})]}),Object(rt.jsx)(ft.a,{item:!0,xs:2,children:Object(rt.jsxs)("div",{children:[Object(rt.jsx)("p",{children:"Alto:"}),Object(rt.jsx)("input",{value:u,type:"number",step:"1",onChange:function(t){var e=parseInt(t.target.value.replaceAll(",","").replaceAll(".",""));l(e>40?40:e)}})]})}),Object(rt.jsx)(ft.a,{item:!0,xs:2,children:Object(rt.jsx)(At.a,{variant:"contained",onClick:function(){e({width:r,height:u})},children:"Actualizar"})})]})},It=s(210),Et=s.n(It),Lt=30,Gt=function(){function t(e,s,n){Object(c.a)(this,t);var i=e[1][2].filled,a=e[0][1].filled,r=e[2][1].filled,o=e[1][0].filled;this.rotation=this.determineStreetRotation(a,o,r,i),this.long=[Lt,Lt],this.position=[s*Lt+15,n*Lt+15]}return Object(u.a)(t,[{key:"isStraight",value:function(){return!1}},{key:"determineStreetRotation",value:function(){}},{key:"getAsJSON",value:function(){return{position_x:this.position[0],position_y:this.position[1],rotation:this.rotation,long_x:this.long[0],long_y:this.long[1]}}}],[{key:"isValidNinePerNineGrid",value:function(t){}},{key:"sumValueForCell",value:function(t){return t.filled?1:0}},{key:"calculateNeighboursFilled",value:function(t){var e=0,s=0;return[e+=this.sumValueForCell(t[1][0])+this.sumValueForCell(t[1][2]),s+=this.sumValueForCell(t[0][1])+this.sumValueForCell(t[2][1])]}}]),t}(),Bt={TOP_TO_LEFT:0,LEFT_TO_BOT:Math.PI/2,BOT_TO_RIGHT:Math.PI,RIGHT_TO_TOP:3*Math.PI/2},Ht=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(u.a)(s,[{key:"determineStreetRotation",value:function(t,e,s,n){return t&&e?Bt.TOP_TO_LEFT:e&&s?Bt.LEFT_TO_BOT:s&&n?Bt.BOT_TO_RIGHT:n&&t?Bt.RIGHT_TO_TOP:void 0}},{key:"getAsJSON",value:function(){var t=Object(j.a)(Object(y.a)(s.prototype),"getAsJSON",this).call(this);return t.type="CURVE",t}}],[{key:"isValidNinePerNineGrid",value:function(t){var e=this.calculateNeighboursFilled(t),s=Object(dt.a)(e,2),n=s[0],i=s[1];return 1===n&&1===i}}]),s}(Gt),Nt=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(u.a)(s,[{key:"determineStreetRotation",value:function(){return 0}},{key:"getAsJSON",value:function(){var t=Object(j.a)(Object(y.a)(s.prototype),"getAsJSON",this).call(this);return t.type="INTERSECTION",t}}],[{key:"isValidNinePerNineGrid",value:function(t){var e=Gt.calculateNeighboursFilled(t),s=Object(dt.a)(e,2),n=s[0];return 2===s[1]&&2===n}}]),s}(Gt),Wt={HORIZONTAL:0,VERTICAL:Math.PI/2},_t=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(u.a)(s,[{key:"determineStreetRotation",value:function(t,e,s,n){return t&&s?Wt.VERTICAL:e&&n?Wt.HORIZONTAL:void 0}},{key:"isStraight",value:function(){return!0}},{key:"getAsJSON",value:function(){var t=Object(j.a)(Object(y.a)(s.prototype),"getAsJSON",this).call(this);return t.type="STRAIGHT",t}}],[{key:"isValidNinePerNineGrid",value:function(t){var e=Gt.calculateNeighboursFilled(t),s=Object(dt.a)(e,2),n=s[0],i=s[1];return 2===i&&0===n||0===i&&2===n}}]),s}(Gt),Vt={TOP_SINGLE:0,LEFT_SINGLE:Math.PI/2,BOT_SINGLE:Math.PI,RIGHT_SINGLE:3*Math.PI/2},Ft=function(t){Object(l.a)(s,t);var e=Object(d.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(u.a)(s,[{key:"determineStreetRotation",value:function(t,e,s,n){return t&&e&&n?Vt.TOP_SINGLE:e&&s&&t?Vt.LEFT_SINGLE:s&&n&&e?Vt.BOT_SINGLE:n&&t&&s?Vt.RIGHT_SINGLE:void 0}},{key:"getAsJSON",value:function(){var t=Object(j.a)(Object(y.a)(s.prototype),"getAsJSON",this).call(this);return t.type="T_STREET",t}}],[{key:"isValidNinePerNineGrid",value:function(t){var e=Gt.calculateNeighboursFilled(t),s=Object(dt.a)(e,2),n=s[0],i=s[1];return 2===i&&1===n||1===i&&2===n}}]),s}(Gt),zt=[_t,Ht,Ft,Nt],Ut=function(){function t(e,s){Object(c.a)(this,t),this.levelGrid=e,this.getNinePerNineGrid=s?this.getNinePerNineGridInfinite:this.getNinePerNineGridFinite}return Object(u.a)(t,[{key:"constructStreets",value:function(){for(var t=[],e=[],s=0;s<this.levelGrid.length;s++)for(var n=0;n<this.levelGrid[s].length;n++){if(this.levelGrid[s][n].filled){var i=this.defineTypeOfStreet(s,n);i.isStraight()?t.push(i):e.push(i)}}var a=this.linkStraightStreets(t);return[].concat(Object(lt.a)(a),e).map((function(t){return t.getAsJSON()}))}},{key:"getNinePerNineGridInfinite",value:function(t,e){for(var s=[],n=t-1;n<=t+1;n++){for(var i=[],a=n<0?this.levelGrid.length-1:n%this.levelGrid.length,r=e-1;r<=e+1;r++){var o=r<0?this.levelGrid[a].length-1:r%this.levelGrid[a].length;i.push(this.levelGrid[a][o])}s.push(i)}return s}},{key:"getNinePerNineGridFinite",value:function(t,e){for(var s=[],n={filled:!1},i=t-1;i<=t+1;i++)if(i<0||i===this.levelGrid.length)s.push([n,n,n]);else{for(var a=[],r=e-1;r<=e+1;r++)r<0||r===this.levelGrid[i].length?a.push(n):a.push(this.levelGrid[i][r]);s.push(a)}return s}},{key:"defineTypeOfStreet",value:function(t,e){for(var s=this.getNinePerNineGrid(t,e),n=!1,i=void 0,a=0;a<zt.length&&!n;a++)n=zt[a].isValidNinePerNineGrid(s),i=zt[a];if(!n)throw new Error("No se pudo definir el tipo de calle dentro de los tipos validos.");return new i(s,this.levelGrid.length-1-t,e)}},{key:"linkStraightStreets",value:function(t){return t}}]),t}();function Xt(t,e,s){for(var n=0,i=e-1;i<=e+1&&i<t.length;i++)i>=0&&i!==e&&(n+=t[i][s].filled?1:0);for(var a=s-1;a<=s+1&&a<t[e].length;a++)a>=0&&a!==s&&(n+=t[e][a].filled?1:0);return n}function qt(t,e){return e?void 0:function(t){for(var e=!0,s=[],n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)t[n][i].filled&&Xt(t,n,i)<=1&&(e=!1,s.push([n,i]));return{valid:e,wrongCells:s}}(t)}var Jt="darkgray",Yt="white",Qt="orange",Zt=function(t){var e=t.gridDimensions,s=Object(n.useState)([]),i=Object(dt.a)(s,2),a=i[0],r=i[1],o=Object(n.useState)(!1),h=Object(dt.a)(o,2),c=h[0],u=h[1],l=Object(n.useState)(!1),d=Object(dt.a)(l,2),b=d[0],p=d[1];Object(n.useEffect)((function(){for(var t=[],s=0;s<e.height;s++){for(var n=[],i=0;i<e.width;i++){var a={filled:!1,div_color:Yt};n.push(a)}t.push(n)}r(t)}),[e.width,e.height]),Object(n.useEffect)((function(){window.addEventListener("mouseup",(function(t){t.preventDefault(),0===t.button?u(!1):2===t.button&&p(!1)})),window.addEventListener("contextmenu",(function(t){t.preventDefault()}))}),[]);var f=function(t,e){if(!e||!t)return!1;for(var s=0;s<t.length;s++){for(var n=!0,i=0;i<t[s].length;i++)try{t[s][i]!==e[i]&&(n=!1)}catch(a){i=t[s].length,n=!1}if(n)return!0}return!1};return Object(rt.jsxs)("div",{style:{width:600,height:600,marginTop:25,marginLeft:"auto",marginRight:"auto"},onMouseDown:function(t){t.preventDefault(),0===t.button?u(!0):2===t.button&&p(!0)},children:[a.map((function(t,s){return Object(rt.jsx)("div",{className:"row-level-grid",id:"row_".concat(s),style:{width:"100%",height:600/e.height,display:"flex",flexDirection:"row"},children:t.map((function(t,n){return Object(rt.jsx)("div",{className:"cell-level-grid",id:"cell_".concat(s,"_").concat(n),style:{backgroundColor:t.div_color,width:"".concat(100/e.width,"%"),height:"100%",border:"1px solid black"},onMouseMove:function(t){t.preventDefault(),function(t,e){if(c){var s=Object(lt.a)(a);s[t][e].filled=!0,s[t][e].div_color=Jt,r(s)}else if(b){var n=Object(lt.a)(a);n[t][e].filled=!1,n[t][e].div_color=Yt,r(n)}}(s,n)},onMouseUp:function(t){!function(t,e,s){if(0===s){var n=Object(lt.a)(a);n[t][e].filled=!0,n[t][e].div_color=Jt,r(n)}else if(2===s){var i=Object(lt.a)(a);i[t][e].filled=!1,i[t][e].div_color=Yt,r(i)}}(s,n,t.button)}},"cell_".concat(s,"_").concat(n))}))},"row_".concat(s))})),Object(rt.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:40},children:Object(rt.jsxs)(At.a,{variant:"contained",onClick:function(){for(var t=qt(a),e=Object(lt.a)(a),s=0;s<a.length;s++)for(var n=0;n<a[s].length;n++)e[s][n].filled&&(e[s][n].div_color=f(t.wrongCells,[s,n])?Qt:Jt);r(e),t.valid&&function(t,e){var s="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),n=document.createElement("a");n.setAttribute("href",s),n.setAttribute("download",e+".json"),document.body.appendChild(n),n.click(),n.remove()}(function(t){return{streets:new Ut(t).constructStreets()}}(a),"Driving_Simulator_Custom_Level.json")},color:"success",children:[Object(rt.jsx)(Et.a,{})," Procesar nivel..."]})})]})},Kt=function(){var t=Object(n.useState)(!1),e=Object(dt.a)(t,2),s=e[0],a=e[1],r=Object(n.useState)(!1),o=Object(dt.a)(r,2),h=o[0],c=o[1],u=Object(n.useState)([]),l=Object(dt.a)(u,2),d=l[0],b=l[1],p=Object(n.useState)(null),f=Object(dt.a)(p,2),v=f[0],g=f[1],m=Object(n.useState)({width:20,height:20}),j=Object(dt.a)(m,2),y=j[0],w=j[1];return i.a.useEffect((function(){null!==v&&b((function(t){return[].concat(Object(lt.a)(t),[v])}))}),[v]),Object(rt.jsx)(rt.Fragment,{children:Object(rt.jsxs)(St.Provider,{value:{lastSelectedItem:v,setLastSelectedItem:g},children:[Object(rt.jsxs)("div",{children:[Object(rt.jsxs)("div",{style:{flexDirection:"row",justifyContent:"space-between",display:"flex"},children:[Object(rt.jsx)(bt.a,{onClick:function(){return a(!0)},style:{height:40,margin:10},className:"header",children:Object(rt.jsx)(Ct.a,{})}),Object(rt.jsx)("h1",{children:"Driving Simulator - Level Editor"}),Object(rt.jsx)(bt.a,{onClick:function(){return c(!0)},style:{height:40,margin:10},className:"header",children:Object(rt.jsx)(Mt.a,{})})]}),Object(rt.jsxs)("div",{children:[Object(rt.jsx)(Dt,{setGridDimensions:w,gridDimensions:y}),Object(rt.jsx)(Zt,{gridDimensions:y}),d.map((function(t,e){return Object(rt.jsx)("span",{},e)}))]})]}),Object(rt.jsx)(Rt,{openItems:s,handleDrawerClose:function(){a(!1)}}),Object(rt.jsx)(wt,{openConfigs:h,handleDrawerClose:function(){c(!1)}})]})})},$t=s(56),te="http://localhost:8001",ee=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,se=Object(n.createContext)(void 0),ne=s(388),ie=s(385),ae=s(389),re=s(104),oe=s(383),he=s(384),ce=s(239).createHash,ue=function(t){return ce("sha256").update(t).digest("hex")},le=function(){var t=Object(ht.m)(),e=i.a.useState(""),s=Object(dt.a)(e,2),a=s[0],r=s[1],c=i.a.useState(""),u=Object(dt.a)(c,2),l=u[0],d=u[1],b=i.a.useState(!1),p=Object(dt.a)(b,2),f=p[0],v=p[1],g=i.a.useState(void 0),m=Object(dt.a)(g,2),j=m[0],y=m[1],w=function(){var t=Object(n.useContext)(se),e=t.session,s=t.setSession;return{setSessionWithResponse:function(t){s({user:t.user,jwt:t.jwt})},getUser:function(){return e.user?e.user:void 0},getJWT:function(){return e.jwt?e.jwt:void 0}}}().setSessionWithResponse,O=function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e,s,n,i;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(te,"/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:ue(l)})});case 3:if(200===(e=t.sent).status){t.next=11;break}return t.next=7,e.json();case 7:throw s=t.sent,n=s.detail[0].msg?s.detail[0].msg:s.detail,i=e.status+" - "+e.statusText+" - "+n,new Error(i);case 11:return t.abrupt("return",e.json());case 14:throw t.prev=14,t.t0=t.catch(0),new Error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(){return t.apply(this,arguments)}}(),x=function(){var t=[];return""===l&&t.push("El campo contrase\xf1a se encuentra vac\xedo."),""===a&&t.push("El campo email se encuentra vac\xedo"),a.match(ee)||t.push("El email establecido es inv\xe1lido."),!(t.length>0)||(y(t),!1)},S=function(){var e=Object(h.a)(Object(o.a)().mark((function e(s){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),x()){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,O();case 6:n=e.sent,w(n),t("/"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),y([e.t0.toString().replaceAll("Error: ","")]);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var t=Object(h.a)(Object(o.a)().mark((function t(e){var s,n,i,a;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(te,"/users/login_google"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});case 2:if(200===(s=t.sent).status){t.next=10;break}return t.next=6,s.json();case 6:throw n=t.sent,i=n.detail[0].msg?n.detail[0].msg:n.detail,a=s.status+" - "+s.statusText+" - "+i,new Error(a);case 10:return t.abrupt("return",s.json());case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),R=function(){var t=Object(h.a)(Object(o.a)().mark((function t(e){var s;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,P(e);case 3:s=t.sent,w(s),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),y([t.t0.toString().replaceAll("Error: ","")]);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}();return Object(rt.jsx)("form",{onSubmit:S,children:Object(rt.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignContent:"center",flexDirection:"column",textAlign:"center",margin:"auto",marginTop:40,padding:30,border:"2px solid black",borderRadius:20,maxWidth:400},children:[j&&Object(rt.jsxs)(ne.a,{severity:"error",style:{textAlign:"justify"},onClose:function(){return y(void 0)},children:["Han ocurrido los siguientes errores:",Object(rt.jsx)("ul",{children:j.map((function(t,e){return Object(rt.jsx)("li",{children:t},e)}))})]}),Object(rt.jsx)("h1",{children:"Iniciar Sesi\xf3n"}),Object(rt.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(rt.jsx)("img",{src:"logo_transp.png",width:"25%",alt:"Driving Simulator Logo"})}),Object(rt.jsx)("div",{style:{marginTop:20},children:Object(rt.jsx)(ie.a,{style:{width:"80%"},type:"text",onChange:function(t){return r(t.target.value)},value:a,name:"email",label:"E-Mail"})}),Object(rt.jsx)("div",{style:{marginTop:20},children:Object(rt.jsx)(ie.a,{style:{width:"80%"},type:f?"text":"password",onChange:function(t){return d(t.target.value)},value:l,name:"password",label:"Contrase\xf1a",InputProps:{endAdornment:Object(rt.jsx)(ae.a,{position:"end",children:Object(rt.jsx)(bt.a,{"aria-label":"toggle password visibility",onClick:function(){return v(!f)},children:f?Object(rt.jsx)(oe.a,{}):Object(rt.jsx)(he.a,{})})})}})}),Object(rt.jsx)("div",{style:{marginTop:20},children:Object(rt.jsx)(At.a,{variant:"contained",type:"submit",children:"Iniciar Sesi\xf3n"})}),Object(rt.jsx)("div",{style:{marginTop:20},children:Object(rt.jsx)($t.b,{to:"/signup",children:"\xbfNo posees una cuenta? Registrate aqu\xed..."})}),Object(rt.jsx)("div",{style:{marginTop:20,display:"flex",justifyContent:"center",textAlign:"center",alignContent:"center"},children:Object(rt.jsx)(re.a,{onSuccess:function(t){var e=t.credential;R(e)},onError:function(){y(["El inicio de sesi\xf3n con Google ha fallado."])}})})]})})},de=function(){var t=i.a.useState(""),e=Object(dt.a)(t,2),s=e[0],n=e[1],a=i.a.useState(""),r=Object(dt.a)(a,2),c=r[0],u=r[1],l=i.a.useState(""),d=Object(dt.a)(l,2),b=d[0],p=d[1],f=i.a.useState(""),v=Object(dt.a)(f,2),g=v[0],m=v[1],j=i.a.useState(!1),y=Object(dt.a)(j,2),w=y[0],O=y[1],x=i.a.useState(void 0),S=Object(dt.a)(x,2),P=S[0],R=S[1],k=function(){var t=[];return""!==s&&""!==c&&""!==b&&""!==g||t.push("A\xfan existen campos sin completar."),c!==b&&t.push("Las contrase\xf1as establecidas no coinciden."),c.length<8&&t.push("La contrase\xf1a debe tener una longitud m\xednima de 8 caracteres."),s.match(ee)||t.push("El email establecido es inv\xe1lido."),t.length>0?(R(t),!1):(R(void 0),!0)},M=function(){var t=Object(h.a)(Object(o.a)().mark((function t(){var e,n,i,a,r;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="".concat(te,"/users/register"),t.prev=1,t.next=4,fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s,password:ue(c),name_to_show:g})});case 4:if(200===(n=t.sent).status){t.next=12;break}return t.next=8,n.json();case 8:throw i=t.sent,a=i.detail[0].msg?i.detail[0].msg:i.detail,r=n.status+" - "+n.statusText+" - "+a,new Error(r);case 12:return t.abrupt("return",n.json());case 15:throw t.prev=15,t.t0=t.catch(1),new Error(t.t0);case 18:case"end":return t.stop()}}),t,null,[[1,15]])})));return function(){return t.apply(this,arguments)}}(),T=function(){var t=Object(h.a)(Object(o.a)().mark((function t(e){var s;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),k()){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,M();case 5:s=t.sent,console.log(s);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(rt.jsx)("form",{onSubmit:T,children:Object(rt.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignContent:"center",flexDirection:"column",textAlign:"center",margin:"auto",marginTop:40,padding:30,border:"2px solid black",borderRadius:20,maxWidth:400},children:[P&&Object(rt.jsxs)(ne.a,{severity:"error",style:{textAlign:"justify"},onClose:function(){return R(void 0)},children:["Han ocurrido los siguientes errores:",Object(rt.jsx)("ul",{children:P.map((function(t,e){return Object(rt.jsx)("li",{children:t},e)}))})]}),Object(rt.jsx)("h1",{children:"Crea tu cuenta"}),Object(rt.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(rt.jsx)("img",{src:"logo_transp.png",width:"25%",alt:"Driving Simulator Logo"})}),Object(rt.jsx)("div",{style:{marginTop:20},children:Object(rt.jsx)(ie.a,{style:{width:"80%"},type:"text",onChange:function(t){return n(t.target.value)},value:s,name:"email",label:"E-Mail"})}),Object(rt.jsx)("div",{style:{marginTop:20},children:Object(rt.jsx)(ie.a,{style:{width:"80%"},type:"text",onChange:function(t){return m(t.target.value)},value:g,name:"username",label:"Nombre para mostrar"})}),Object(rt.jsx)("div",{style:{marginTop:20},children:Object(rt.jsx)(ie.a,{style:{width:"80%"},type:w?"text":"password",onChange:function(t){return u(t.target.value)},value:c,name:"password",label:"Contrase\xf1a",InputProps:{endAdornment:Object(rt.jsx)(ae.a,{position:"end",children:Object(rt.jsx)(bt.a,{"aria-label":"toggle password visibility",onClick:function(){return O(!w)},children:w?Object(rt.jsx)(oe.a,{}):Object(rt.jsx)(he.a,{})})})}})}),Object(rt.jsx)("div",{style:{marginTop:20},children:Object(rt.jsx)(ie.a,{style:{width:"80%"},type:w?"text":"password",onChange:function(t){return p(t.target.value)},value:b,name:"passwordConfirmation",label:"Repetir Contrase\xf1a"})}),Object(rt.jsx)("div",{style:{marginTop:20},children:Object(rt.jsx)(At.a,{variant:"contained",type:"submit",children:"CREAR CUENTA"})}),Object(rt.jsx)("div",{style:{marginTop:20},children:Object(rt.jsx)($t.b,{to:"/login",children:"\xbfYa poses una cuenta? Inicia sesi\xf3n..."})})]})})},be=function(t){var e=t.childElement,s=Object(n.useState)({user:void 0,jwt:void 0}),i=Object(dt.a)(s,2),a=i[0],r=i[1];return Object(rt.jsx)(re.b,{clientId:"18785041157-s9ga39r0i6up45radtj3soo6je1pneon.apps.googleusercontent.com",children:Object(rt.jsx)(se.Provider,{value:{session:a,setSession:r},children:e})})};var pe=function(){return Object(n.useEffect)((function(){document.title="Driving Simulator"}),[]),Object(rt.jsx)(be,{childElement:Object(rt.jsx)($t.a,{children:Object(rt.jsxs)(ht.c,{children:[Object(rt.jsx)(ht.a,{exact:!0,path:"/scene",element:Object(rt.jsx)(ot,{})}),Object(rt.jsx)(ht.a,{exact:!0,path:"/",element:Object(rt.jsx)(ut,{})}),Object(rt.jsx)(ht.a,{exact:!0,path:"/level-editor",element:Object(rt.jsx)(Kt,{})}),Object(rt.jsx)(ht.a,{exact:!0,path:"/login",element:Object(rt.jsx)(le,{})}),Object(rt.jsx)(ht.a,{exact:!0,path:"/signup",element:Object(rt.jsx)(de,{})})]})})})};r.a.createRoot(document.getElementById("root")).render(Object(rt.jsx)(pe,{}))}},[[336,1,2]]]);
//# sourceMappingURL=main.8a3f1d99.chunk.js.map